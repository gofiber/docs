<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-v2.x docs-doc-page docs-doc-id-api/middleware/csrf" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>CSRF | Fiber</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:url content=https://docs.gofiber.io/api/middleware/csrf /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=v2.x /><meta data-rh=true name=docusaurus_tag content=docs-default-v2.x /><meta data-rh=true name=docsearch:version content=v2.x /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-v2.x /><meta data-rh=true property=og:title content="CSRF | Fiber"/><meta data-rh=true name=description content="The CSRF middleware for Fiber provides protection against Cross-Site Request Forgery (CSRF) attacks. Requests made using methods other than those defined as 'safe' by RFC9110#section-9.2.1 (GET, HEAD, OPTIONS, and TRACE) are validated using tokens. If a potential attack is detected, the middleware will return a default 403 Forbidden error."/><meta data-rh=true property=og:description content="The CSRF middleware for Fiber provides protection against Cross-Site Request Forgery (CSRF) attacks. Requests made using methods other than those defined as 'safe' by RFC9110#section-9.2.1 (GET, HEAD, OPTIONS, and TRACE) are validated using tokens. If a potential attack is detected, the middleware will return a default 403 Forbidden error."/><link data-rh=true rel=icon href=/img/favicon.png /><link data-rh=true rel=canonical href=https://docs.gofiber.io/api/middleware/csrf /><link data-rh=true rel=alternate href=https://docs.gofiber.io/api/middleware/csrf hreflang=en /><link data-rh=true rel=alternate href=https://docs.gofiber.io/api/middleware/csrf hreflang=x-default /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://docs.gofiber.io/category/api","name":"API","position":1},{"@type":"ListItem","item":"https://docs.gofiber.io/category/-middleware","name":"🧬 Middleware","position":2},{"@type":"ListItem","item":"https://docs.gofiber.io/api/middleware/csrf","name":"CSRF","position":3}]}</script><style>html{visibility:hidden}html[data-theme]{visibility:visible}</style><script>!function(){var e=function(){try{return window.localStorage.getItem("theme")}catch(e){return null}}(),t=e||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");document.documentElement.setAttribute("data-theme",t),document.documentElement.setAttribute("data-theme-choice",e||"system"),document.documentElement.style.colorScheme=t,document.body&&(document.body.style.colorScheme=t),new MutationObserver(function(){var e=document.documentElement.getAttribute("data-theme");e&&(document.documentElement.style.colorScheme=e,document.body&&(document.body.style.colorScheme=e))}).observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]})}()</script><link rel=icon href=/img/favicon.png><link rel=manifest href=/manifest.json><meta name=theme-color content="rgb(0, 172, 215)"><link rel=stylesheet href=/assets/css/styles.c78623d6.css /><script src=/assets/js/runtime~main.b11ab010.js defer></script><script src=/assets/js/main.bc556500.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" style=background-color:#fafbfc;color:#091E42 role=banner><div class=announcementBarPlaceholder_vyr4></div><div class="content_knG7 announcementBarContent_xLdY">🌟 If you like Fiber, don't forget to give us a star on <a href=https://github.com/gofiber/fiber>Github</a> 🌟</div><button type=button aria-label=Close class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width=14 height=14><g stroke=currentColor stroke-width=3.1><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"/></g></svg></button></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a href=https://gofiber.io target=_self rel="noopener noreferrer" class=navbar__brand><div class=navbar__logo><img src=/img/logo.svg alt="Fiber Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/img/logo-dark.svg alt="Fiber Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/>🏠 Home</a><div class="navbar__item dropdown dropdown--hoverable"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link>🧩 Extra</a><ul class=dropdown__menu><li><a class=dropdown__link href=/contrib/>🧬 Contrib</a><li><a class=dropdown__link href=/storage/>📦 Storage</a><li><a class=dropdown__link href=/template/>️📄️ Template</a></ul></div><a href=https://gofiber.io/support target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">☕ Donate</a><a class="navbar__item navbar__link" href=/recipes/>🍳 Recipes</a><a href=https://github.com/gofiber/awesome-fiber target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">😎 Awesome List</a><a href=https://gofiber.io/discord target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">💬 Chat</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link fiber-versions" aria-haspopup=true aria-expanded=false role=button href=/api/middleware/csrf>v2.x</a><ul class=dropdown__menu><li><a class=dropdown__link href=/next/>Next</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/api/middleware/csrf>v2.x</a><li><a class=dropdown__link href=/v1.x/>v1.x</a></ul></div><a href=https://github.com/gofiber/fiber target=_blank rel="noopener noreferrer" position=right class="navbar__item navbar__link github-stars-navbar-item" aria-label="Fiber on GitHub (loading star count)"><span class=github-stars-navbar-item__icon aria-hidden=true>⭐</span><span class=github-stars-navbar-item__count>…</span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class="navbar__link header-github-link" aria-label="GitHub Repository"></a><ul class=dropdown__menu><li><a href=https://github.com/gofiber/fiber target=_blank rel="noopener noreferrer" class=dropdown__link>🚀 Fiber<svg width=12 height=12 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li><a href=https://github.com/gofiber/contrib target=_blank rel="noopener noreferrer" class=dropdown__link>🧬 Contrib<svg width=12 height=12 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li><a href=https://github.com/gofiber/storage target=_blank rel="noopener noreferrer" class=dropdown__link>📦 Storage<svg width=12 height=12 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li><a href=https://github.com/gofiber/template target=_blank rel="noopener noreferrer" class=dropdown__link>📄️ Template<svg width=12 height=12 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li><a href=https://github.com/gofiber/recipes target=_blank rel="noopener noreferrer" class=dropdown__link>🍳️ Recipes<svg width=12 height=12 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><div class="navbar__search searchBarContainer_NW3z" dir=ltr><input placeholder=Search aria-label=Search class="navbar__search-input searchInput_YFbd" value="" /><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/><span title="👋 Welcome" class=linkLabel_WmDU>👋 Welcome</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href=/category/api><span title=API class=categoryLinkLabel_W154>API</span></a><button aria-label="Collapse sidebar category 'API'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/api/fiber><span title="📦 Fiber" class=linkLabel_WmDU>📦 Fiber</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/api/app><span title="🚀 App" class=linkLabel_WmDU>🚀 App</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/api/ctx><span title="🧠 Ctx" class=linkLabel_WmDU>🧠 Ctx</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/api/constants><span title="📋 Constants" class=linkLabel_WmDU>📋 Constants</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/api/client><span title="🌎 Client" class=linkLabel_WmDU>🌎 Client</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/api/log><span title="📃 Log" class=linkLabel_WmDU>📃 Log</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex=0 href=/category/-middleware><span title="🧬 Middleware" class=categoryLinkLabel_W154>🧬 Middleware</span></a><button aria-label="Collapse sidebar category '🧬 Middleware'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/adaptor><span title=Adaptor class=linkLabel_WmDU>Adaptor</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/basicauth><span title=BasicAuth class=linkLabel_WmDU>BasicAuth</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/cache><span title=Cache class=linkLabel_WmDU>Cache</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/compress><span title=Compress class=linkLabel_WmDU>Compress</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/cors><span title=CORS class=linkLabel_WmDU>CORS</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/api/middleware/csrf><span title=CSRF class=linkLabel_WmDU>CSRF</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/earlydata><span title=EarlyData class=linkLabel_WmDU>EarlyData</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/encryptcookie><span title="Encrypt Cookie" class=linkLabel_WmDU>Encrypt Cookie</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/envvar><span title=EnvVar class=linkLabel_WmDU>EnvVar</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/etag><span title=ETag class=linkLabel_WmDU>ETag</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/expvar><span title=ExpVar class=linkLabel_WmDU>ExpVar</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/favicon><span title=Favicon class=linkLabel_WmDU>Favicon</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/filesystem><span title=FileSystem class=linkLabel_WmDU>FileSystem</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/healthcheck><span title="Health Check" class=linkLabel_WmDU>Health Check</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/helmet><span title=Helmet class=linkLabel_WmDU>Helmet</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/idempotency><span title=Idempotency class=linkLabel_WmDU>Idempotency</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/keyauth><span title=Keyauth class=linkLabel_WmDU>Keyauth</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/limiter><span title=Limiter class=linkLabel_WmDU>Limiter</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/logger><span title=Logger class=linkLabel_WmDU>Logger</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/monitor><span title=Monitor class=linkLabel_WmDU>Monitor</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/pprof><span title=Pprof class=linkLabel_WmDU>Pprof</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/proxy><span title=Proxy class=linkLabel_WmDU>Proxy</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/recover><span title=Recover class=linkLabel_WmDU>Recover</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/redirect><span title=Redirect class=linkLabel_WmDU>Redirect</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/requestid><span title=RequestID class=linkLabel_WmDU>RequestID</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/rewrite><span title=Rewrite class=linkLabel_WmDU>Rewrite</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/session><span title=Session class=linkLabel_WmDU>Session</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/skip><span title=Skip class=linkLabel_WmDU>Skip</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/api/middleware/timeout><span title=Timeout class=linkLabel_WmDU>Timeout</span></a></ul></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/category/guide><span title=Guide class=categoryLinkLabel_W154>Guide</span></a><button aria-label="Collapse sidebar category 'Guide'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/guide/routing><span title="🔌 Routing" class=linkLabel_WmDU>🔌 Routing</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/guide/grouping><span title="🎭 Grouping" class=linkLabel_WmDU>🎭 Grouping</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/guide/templates><span title="📝 Templates" class=linkLabel_WmDU>📝 Templates</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/guide/error-handling><span title="🐛 Error Handling" class=linkLabel_WmDU>🐛 Error Handling</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/guide/validation><span title="🔎 Validation" class=linkLabel_WmDU>🔎 Validation</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/guide/hooks><span title="🎣 Hooks" class=linkLabel_WmDU>🎣 Hooks</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/guide/faster-fiber><span title="⚡ Make Fiber Faster" class=linkLabel_WmDU>⚡ Make Fiber Faster</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/category/extra><span title=Extra class=categoryLinkLabel_W154>Extra</span></a><button aria-label="Collapse sidebar category 'Extra'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/extra/faq><span title="🤔 FAQ" class=linkLabel_WmDU>🤔 FAQ</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/extra/benchmarks><span title="📊 Benchmarks" class=linkLabel_WmDU>📊 Benchmarks</span></a></ul></ul></nav><button type=button title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/category/api><span>API</span></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/category/-middleware><span>🧬 Middleware</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>CSRF</span></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v2.x</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>CSRF</h1></header>
<p>The CSRF middleware for <a href=https://github.com/gofiber/fiber target=_blank rel="noopener noreferrer" class="">Fiber</a> provides protection against <a href=https://en.wikipedia.org/wiki/Cross-site_request_forgery target=_blank rel="noopener noreferrer" class="">Cross-Site Request Forgery</a> (CSRF) attacks. Requests made using methods other than those defined as 'safe' by <a href=https://datatracker.ietf.org/doc/html/rfc9110.html#section-9.2.1 target=_blank rel="noopener noreferrer" class="">RFC9110#section-9.2.1</a> (GET, HEAD, OPTIONS, and TRACE) are validated using tokens. If a potential attack is detected, the middleware will return a default 403 Forbidden error.</p>
<p>This middleware offers two <a href=#token-validation-patterns class="">Token Validation Patterns</a>: the <a href=#double-submit-cookie-pattern-default class="">Double Submit Cookie Pattern (default)</a>, and the <a href=#synchronizer-token-pattern-with-session class="">Synchronizer Token Pattern (with Session)</a>.</p>
<p>As a <a href=#defense-in-depth class="">Defense In Depth</a> measure, this middleware performs <a href=#referer-checking class="">Referer Checking</a> for HTTPS requests.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=token-generation>Token Generation<a href=#token-generation class=hash-link aria-label="Direct link to Token Generation" title="Direct link to Token Generation" translate=no>​</a></h2>
<p>CSRF tokens are generated on 'safe' requests and when the existing token has expired or hasn't been set yet. If <code>SingleUseToken</code> is <code>true</code>, a new token is generated after each use. Retrieve the CSRF token using <code>c.Locals(contextKey)</code>, where <code>contextKey</code> is defined within the configuration.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=security-considerations>Security Considerations<a href=#security-considerations class=hash-link aria-label="Direct link to Security Considerations" title="Direct link to Security Considerations" translate=no>​</a></h2>
<p>This middleware is designed to protect against CSRF attacks but does not protect against other attack vectors, such as XSS. It should be used in combination with other security measures.</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"/></svg></span>danger</div><div class=admonitionContent_BuS1><p>Never use 'safe' methods to mutate data, for example, never use a GET request to modify a resource. This middleware will not protect against CSRF attacks on 'safe' methods.</div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=token-validation-patterns>Token Validation Patterns<a href=#token-validation-patterns class=hash-link aria-label="Direct link to Token Validation Patterns" title="Direct link to Token Validation Patterns" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=double-submit-cookie-pattern-default>Double Submit Cookie Pattern (Default)<a href=#double-submit-cookie-pattern-default class=hash-link aria-label="Direct link to Double Submit Cookie Pattern (Default)" title="Direct link to Double Submit Cookie Pattern (Default)" translate=no>​</a></h4>
<p>By default, the middleware generates and stores tokens using the <code>fiber.Storage</code> interface. These tokens are not linked to any particular user session, and they are validated using the Double Submit Cookie pattern. The token is stored in a cookie, and then sent as a header on requests. The middleware compares the cookie value with the header value to validate the token. This is a secure pattern that does not require a user session.</p>
<p>When the authorization status changes, the previously issued token MUST be deleted, and a new one generated. See <a href=#token-lifecycle class="">Token Lifecycle</a> <a href=#deleting-tokens class="">Deleting Tokens</a> for more information.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 16 16"><path fill-rule=evenodd d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg></span>caution</div><div class=admonitionContent_BuS1><p>When using this pattern, it's important to set the <code>CookieSameSite</code> option to <code>Lax</code> or <code>Strict</code> and ensure that the Extractor is not <code>CsrfFromCookie</code>, and KeyLookup is not <code>cookie:&lt;name></code>.</div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_BuS1><p>When using this pattern, this middleware uses our <a href=https://github.com/gofiber/storage target=_blank rel="noopener noreferrer" class="">Storage</a> package to support various databases through a single interface. The default configuration for Storage saves data to memory. See <a href=#custom-storagedatabase class="">Custom Storage/Database</a> for customizing the storage.</div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=synchronizer-token-pattern-with-session>Synchronizer Token Pattern (with Session)<a href=#synchronizer-token-pattern-with-session class=hash-link aria-label="Direct link to Synchronizer Token Pattern (with Session)" title="Direct link to Synchronizer Token Pattern (with Session)" translate=no>​</a></h4>
<p>When using this middleware with a user session, the middleware can be configured to store the token within the session. This method is recommended when using a user session, as it is generally more secure than the Double Submit Cookie Pattern.</p>
<p>When using this pattern it's important to regenerate the session when the authorization status changes, this will also delete the token. See: <a href=#token-lifecycle class="">Token Lifecycle</a> for more information.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 16 16"><path fill-rule=evenodd d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg></span>caution</div><div class=admonitionContent_BuS1><p>Pre-sessions are required and will be created automatically if not present. Use a session value to indicate authentication instead of relying on presence of a session.</div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=defense-in-depth>Defense In Depth<a href=#defense-in-depth class=hash-link aria-label="Direct link to Defense In Depth" title="Direct link to Defense In Depth" translate=no>​</a></h3>
<p>When using this middleware, it's recommended to serve your pages over HTTPS, set the <code>CookieSecure</code> option to <code>true</code>, and set the <code>CookieSameSite</code> option to <code>Lax</code> or <code>Strict</code>. This ensures that the cookie is only sent over HTTPS and not on requests from external sites.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_BuS1><p>Cookie prefixes <code>__Host-</code> and <code>__Secure-</code> can be used to further secure the cookie. Note that these prefixes are not supported by all browsers and there are other limitations. See <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#cookie_prefixes target=_blank rel="noopener noreferrer" class="">MDN#Set-Cookie#cookie_prefixes</a> for more information.<p>To use these prefixes, set the <code>CookieName</code> option to <code>__Host-csrf_</code> or <code>__Secure-csrf_</code>.</div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=referer-checking>Referer Checking<a href=#referer-checking class=hash-link aria-label="Direct link to Referer Checking" title="Direct link to Referer Checking" translate=no>​</a></h3>
<p>For HTTPS requests, this middleware performs strict referer checking. Even if a subdomain can set or modify cookies on your domain, it can't force a user to post to your application since that request won't come from your own exact domain.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 16 16"><path fill-rule=evenodd d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg></span>caution</div><div class=admonitionContent_BuS1><p>When HTTPS requests are protected by CSRF, referer checking is always carried out.<p>The Referer header is automatically included in requests by all modern browsers, including those made using the JS Fetch API. However, if you're making use of this middleware with a custom client, it's important to ensure that the client sends a valid Referer header.</div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=token-lifecycle>Token Lifecycle<a href=#token-lifecycle class=hash-link aria-label="Direct link to Token Lifecycle" title="Direct link to Token Lifecycle" translate=no>​</a></h3>
<p>Tokens are valid until they expire or until they are deleted. By default, tokens are valid for 1 hour, and each subsequent request extends the expiration by 1 hour. The token only expires if the user doesn't make a request for the duration of the expiration time.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=token-reuse>Token Reuse<a href=#token-reuse class=hash-link aria-label="Direct link to Token Reuse" title="Direct link to Token Reuse" translate=no>​</a></h4>
<p>By default, tokens may be used multiple times. If you want to delete the token after it has been used, you can set the <code>SingleUseToken</code> option to <code>true</code>. This will delete the token after it has been used, and a new token will be generated on the next request.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>info</div><div class=admonitionContent_BuS1><p>Using <code>SingleUseToken</code> comes with usability trade-offs and is not enabled by default. For example, it can interfere with the user experience if the user has multiple tabs open or uses the back button.</div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=deleting-tokens>Deleting Tokens<a href=#deleting-tokens class=hash-link aria-label="Direct link to Deleting Tokens" title="Direct link to Deleting Tokens" translate=no>​</a></h4>
<p>When the authorization status changes, the CSRF token MUST be deleted, and a new one generated. This can be done by calling <code>handler.DeleteToken(c)</code>.</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> handler</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> ok </span><span class="token operator" style=color:#393A34>:=</span><span class="token plain"> app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>AcquireCtx</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ctx</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>Locals</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">csrf</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">ConfigDefault</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">HandlerContextKey</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">CSRFHandler</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> ok </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> err </span><span class="token operator" style=color:#393A34>:=</span><span class="token plain"> handler</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>DeleteToken</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>AcquireCtx</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ctx</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> err </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>nil</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>// handle error</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_BuS1><p>If you are using this middleware with the fiber session middleware, then you can simply call <code>session.Destroy()</code>, <code>session.Regenerate()</code>, or <code>session.Reset()</code> to delete session and the token stored therein.</div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=breach>BREACH<a href=#breach class=hash-link aria-label="Direct link to BREACH" title="Direct link to BREACH" translate=no>​</a></h3>
<p>It's important to note that the token is sent as a header on every request. If you include the token in a page that is vulnerable to <a href=https://en.wikipedia.org/wiki/BREACH target=_blank rel="noopener noreferrer" class="">BREACH</a>, an attacker may be able to extract the token. To mitigate this, ensure your pages are served over HTTPS, disable HTTP compression, and implement rate limiting for requests.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=signatures>Signatures<a href=#signatures class=hash-link aria-label="Direct link to Signatures" title="Direct link to Signatures" translate=no>​</a></h2>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>func</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>New</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">config </span><span class="token operator" style=color:#393A34>...</span><span class="token plain">Config</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> fiber</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Handler</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=examples>Examples<a href=#examples class=hash-link aria-label="Direct link to Examples" title="Direct link to Examples" translate=no>​</a></h2>
<p>Import the middleware package that is part of the Fiber web framework:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"github.com/gofiber/fiber/v2"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"github.com/gofiber/fiber/v2/middleware/csrf"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br/></span></code></pre></div></div>
<p>After initializing your Fiber app, you can use the following code to initialize the middleware:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// Initialize default config</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>Use</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">csrf</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>New</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// Or extend your config for customization</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>Use</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">csrf</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>New</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">csrf</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Config</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    KeyLookup</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">      </span><span class="token string" style=color:#e3116c>"header:X-Csrf-Token"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    CookieName</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">     </span><span class="token string" style=color:#e3116c>"csrf_"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	CookieSameSite</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Lax"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    Expiration</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">     </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> time</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Hour</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    KeyGenerator</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">   utils</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">UUIDv4</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=config>Config<a href=#config class=hash-link aria-label="Direct link to Config" title="Direct link to Config" translate=no>​</a></h2>
<table><thead><tr><th style=text-align:left>Property<th style=text-align:left>Type<th style=text-align:left>Description<th style=text-align:left>Default<tbody><tr><td style=text-align:left>Next<td style=text-align:left><code>func(*fiber.Ctx) bool</code><td style=text-align:left>Next defines a function to skip this middleware when returned true.<td style=text-align:left><code>nil</code><tr><td style=text-align:left>KeyLookup<td style=text-align:left><code>string</code><td style=text-align:left>KeyLookup is a string in the form of "<code>&lt;source>:&lt;key></code>" that is used to create an Extractor that extracts the token from the request. Possible values: "<code>header:&lt;name></code>", "<code>query:&lt;name></code>", "<code>param:&lt;name></code>", "<code>form:&lt;name></code>", "<code>cookie:&lt;name></code>". Ignored if an Extractor is explicitly set.<td style=text-align:left>"header<!-- -->:X-Csrf-Token<!-- -->"<tr><td style=text-align:left>CookieName<td style=text-align:left><code>string</code><td style=text-align:left>Name of the csrf cookie. This cookie will store the csrf key.<td style=text-align:left>"csrf_"<tr><td style=text-align:left>CookieDomain<td style=text-align:left><code>string</code><td style=text-align:left>Domain of the CSRF cookie.<td style=text-align:left>""<tr><td style=text-align:left>CookiePath<td style=text-align:left><code>string</code><td style=text-align:left>Path of the CSRF cookie.<td style=text-align:left>""<tr><td style=text-align:left>CookieSecure<td style=text-align:left><code>bool</code><td style=text-align:left>Indicates if the CSRF cookie is secure.<td style=text-align:left>false<tr><td style=text-align:left>CookieHTTPOnly<td style=text-align:left><code>bool</code><td style=text-align:left>Indicates if the CSRF cookie is HTTP-only.<td style=text-align:left>false<tr><td style=text-align:left>CookieSameSite<td style=text-align:left><code>string</code><td style=text-align:left>Value of SameSite cookie.<td style=text-align:left>"Lax"<tr><td style=text-align:left>CookieSessionOnly<td style=text-align:left><code>bool</code><td style=text-align:left>Decides whether the cookie should last for only the browser session. Ignores Expiration if set to true.<td style=text-align:left>false<tr><td style=text-align:left>Expiration<td style=text-align:left><code>time.Duration</code><td style=text-align:left>Expiration is the duration before the CSRF token will expire.<td style=text-align:left>1 * time.Hour<tr><td style=text-align:left>SingleUseToken<td style=text-align:left><code>bool</code><td style=text-align:left>SingleUseToken indicates if the CSRF token be destroyed and a new one generated on each use. (See TokenLifecycle)<td style=text-align:left>false<tr><td style=text-align:left>Storage<td style=text-align:left><code>fiber.Storage</code><td style=text-align:left>Store is used to store the state of the middleware.<td style=text-align:left><code>nil</code><tr><td style=text-align:left>Session<td style=text-align:left><code>*session.Store</code><td style=text-align:left>Session is used to store the state of the middleware. Overrides Storage if set.<td style=text-align:left><code>nil</code><tr><td style=text-align:left>SessionKey<td style=text-align:left><code>string</code><td style=text-align:left>SessionKey is the key used to store the token within the session.<td style=text-align:left>"fiber.csrf.token"<tr><td style=text-align:left>ContextKey<td style=text-align:left><code>inteface{}</code><td style=text-align:left>Context key to store the generated CSRF token into the context. If left empty, the token will not be stored within the context.<td style=text-align:left>""<tr><td style=text-align:left>KeyGenerator<td style=text-align:left><code>func() string</code><td style=text-align:left>KeyGenerator creates a new CSRF token.<td style=text-align:left>utils.UUID<tr><td style=text-align:left>CookieExpires<td style=text-align:left><code>time.Duration</code> (Deprecated)<td style=text-align:left>Deprecated: Please use Expiration.<td style=text-align:left>0<tr><td style=text-align:left>Cookie<td style=text-align:left><code>*fiber.Cookie</code> (Deprecated)<td style=text-align:left>Deprecated: Please use Cookie* related fields.<td style=text-align:left><code>nil</code><tr><td style=text-align:left>TokenLookup<td style=text-align:left><code>string</code> (Deprecated)<td style=text-align:left>Deprecated: Please use KeyLookup.<td style=text-align:left>""<tr><td style=text-align:left>ErrorHandler<td style=text-align:left><code>fiber.ErrorHandler</code><td style=text-align:left>ErrorHandler is executed when an error is returned from fiber.Handler.<td style=text-align:left>DefaultErrorHandler<tr><td style=text-align:left>Extractor<td style=text-align:left><code>func(*fiber.Ctx) (string, error)</code><td style=text-align:left>Extractor returns the CSRF token. If set, this will be used in place of an Extractor based on KeyLookup.<td style=text-align:left>Extractor based on KeyLookup<tr><td style=text-align:left>HandlerContextKey<td style=text-align:left><code>interface{}</code><td style=text-align:left>HandlerContextKey is used to store the CSRF Handler into context.<td style=text-align:left>"fiber.csrf.handler"</table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=default-config>Default Config<a href=#default-config class=hash-link aria-label="Direct link to Default Config" title="Direct link to Default Config" translate=no>​</a></h3>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>var</span><span class="token plain"> ConfigDefault </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Config</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	KeyLookup</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">         </span><span class="token string" style=color:#e3116c>"header:"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> HeaderName</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	CookieName</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">        </span><span class="token string" style=color:#e3116c>"csrf_"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	CookieSameSite</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Lax"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	Expiration</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">        </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> time</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Hour</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	KeyGenerator</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">      utils</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">UUIDv4</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	ErrorHandler</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">      defaultErrorHandler</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	Extractor</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">         </span><span class="token function" style=color:#d73a49>CsrfFromHeader</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">HeaderName</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	SessionKey</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">        </span><span class="token string" style=color:#e3116c>"fiber.csrf.token"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	HandlerContextKey</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"fiber.csrf.handler"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=recommended-config-with-session>Recommended Config (with session)<a href=#recommended-config-with-session class=hash-link aria-label="Direct link to Recommended Config (with session)" title="Direct link to Recommended Config (with session)" translate=no>​</a></h3>
<p>It's recommended to use this middleware with <a href=https://docs.gofiber.io/api/middleware/session target=_blank rel="noopener noreferrer" class="">fiber/middleware/session</a> to store the CSRF token within the session. This is generally more secure than the default configuration.</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>var</span><span class="token plain"> ConfigDefault </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Config</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	KeyLookup</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">         </span><span class="token string" style=color:#e3116c>"header:"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> HeaderName</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	CookieName</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">        </span><span class="token string" style=color:#e3116c>"__Host-csrf_"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	CookieSameSite</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Lax"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	CookieSecure</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">	   </span><span class="token boolean" style=color:#36acaa>true</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	CookieSessionOnly</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>true</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	CookieHTTPOnly</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">    </span><span class="token boolean" style=color:#36acaa>true</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	Expiration</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">        </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> time</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Hour</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	KeyGenerator</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">      utils</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">UUIDv4</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	ErrorHandler</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">      defaultErrorHandler</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	Extractor</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">         </span><span class="token function" style=color:#d73a49>CsrfFromHeader</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">HeaderName</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	Session</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">           session</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Store</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	SessionKey</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain">        </span><span class="token string" style=color:#e3116c>"fiber.csrf.token"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	HandlerContextKey</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"fiber.csrf.handler"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=constants>Constants<a href=#constants class=hash-link aria-label="Direct link to Constants" title="Direct link to Constants" translate=no>​</a></h2>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    HeaderName </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"X-Csrf-Token"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=sentinel-errors>Sentinel Errors<a href=#sentinel-errors class=hash-link aria-label="Direct link to Sentinel Errors" title="Direct link to Sentinel Errors" translate=no>​</a></h2>
<p>The CSRF middleware utilizes a set of sentinel errors to handle various scenarios and communicate errors effectively. These can be used within a <a href=#custom-error-handler class="">custom error handler</a> to handle errors returned by the middleware.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=errors-returned-to-error-handler>Errors Returned to Error Handler<a href=#errors-returned-to-error-handler class=hash-link aria-label="Direct link to Errors Returned to Error Handler" title="Direct link to Errors Returned to Error Handler" translate=no>​</a></h3>
<ul>
<li class=""><code>ErrTokenNotFound</code>: Indicates that the CSRF token was not found.</li>
<li class=""><code>ErrTokenInvalid</code>: Indicates that the CSRF token is invalid.</li>
<li class=""><code>ErrNoReferer</code>: Indicates that the referer was not supplied.</li>
<li class=""><code>ErrBadReferer</code>: Indicates that the referer is invalid.</li>
</ul>
<p>If you use the default error handler, the client will receive a 403 Forbidden error without any additional information.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=custom-error-handler>Custom Error Handler<a href=#custom-error-handler class=hash-link aria-label="Direct link to Custom Error Handler" title="Direct link to Custom Error Handler" translate=no>​</a></h2>
<p>You can use a custom error handler to handle errors returned by the CSRF middleware. The error handler is executed when an error is returned from the middleware. The error handler is passed the error returned from the middleware and the fiber.Ctx.</p>
<p>Example, returning a JSON response for API requests and rendering an error page for other requests:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>Use</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">csrf</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>New</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">csrf</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Config</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	ErrorHandler</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>func</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">c </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">fiber</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Ctx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> err </span><span class="token builtin">error</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">		accepts </span><span class="token operator" style=color:#393A34>:=</span><span class="token plain"> c</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>Accepts</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"html"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"json"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">		path </span><span class="token operator" style=color:#393A34>:=</span><span class="token plain"> c</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>Path</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">		</span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> accepts </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"json"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>||</span><span class="token plain"> strings</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>HasPrefix</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">path</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"/api/"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">			</span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> c</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>Status</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">fiber</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">StatusForbidden</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>JSON</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">fiber</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Map</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">				</span><span class="token string" style=color:#e3116c>"error"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Forbidden"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">			</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">		</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">		</span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> c</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>Status</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">fiber</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">StatusForbidden</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>Render</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"error"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> fiber</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Map</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">			</span><span class="token string" style=color:#e3116c>"Title"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Forbidden"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">			</span><span class="token string" style=color:#e3116c>"Status"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> fiber</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">StatusForbidden</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">		</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"layouts/main"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=custom-storagedatabase>Custom Storage/Database<a href=#custom-storagedatabase class=hash-link aria-label="Direct link to Custom Storage/Database" title="Direct link to Custom Storage/Database" translate=no>​</a></h2>
<p>You can use any storage from our <a href=https://github.com/gofiber/storage/ target=_blank rel="noopener noreferrer" class="">storage</a> package.</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-go codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">storage </span><span class="token operator" style=color:#393A34>:=</span><span class="token plain"> sqlite3</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>New</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>// From github.com/gofiber/storage/sqlite3</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>Use</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">csrf</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>New</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">csrf</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Config</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">	Storage</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> storage</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><br/></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"></div><div class="col lastUpdated_JAkA"><span class=theme-last-updated>Last updated<!-- --> on <b><time datetime=2025-11-01T20:56:48.000Z itemprop=dateModified>Nov 1, 2025</time></b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/api/middleware/cors><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>CORS</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/api/middleware/earlydata><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>EarlyData</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#token-generation class="table-of-contents__link toc-highlight">Token Generation</a><li><a href=#security-considerations class="table-of-contents__link toc-highlight">Security Considerations</a><ul><li><a href=#token-validation-patterns class="table-of-contents__link toc-highlight">Token Validation Patterns</a><li><a href=#defense-in-depth class="table-of-contents__link toc-highlight">Defense In Depth</a><li><a href=#referer-checking class="table-of-contents__link toc-highlight">Referer Checking</a><li><a href=#token-lifecycle class="table-of-contents__link toc-highlight">Token Lifecycle</a><li><a href=#breach class="table-of-contents__link toc-highlight">BREACH</a></ul><li><a href=#signatures class="table-of-contents__link toc-highlight">Signatures</a><li><a href=#examples class="table-of-contents__link toc-highlight">Examples</a><li><a href=#config class="table-of-contents__link toc-highlight">Config</a><ul><li><a href=#default-config class="table-of-contents__link toc-highlight">Default Config</a><li><a href=#recommended-config-with-session class="table-of-contents__link toc-highlight">Recommended Config (with session)</a></ul><li><a href=#constants class="table-of-contents__link toc-highlight">Constants</a><li><a href=#sentinel-errors class="table-of-contents__link toc-highlight">Sentinel Errors</a><ul><li><a href=#errors-returned-to-error-handler class="table-of-contents__link toc-highlight">Errors Returned to Error Handler</a></ul><li><a href=#custom-error-handler class="table-of-contents__link toc-highlight">Custom Error Handler</a><li><a href=#custom-storagedatabase class="table-of-contents__link toc-highlight">Custom Storage/Database</a></ul></div></div></div></div></main></div></div></div></div>
<script src=/inkeepChatButton.js type=module></script></body>