"use strict";(self.webpackChunkfiber_docs=self.webpackChunkfiber_docs||[]).push([["72571"],{74777:function(e,r,t){t.r(r),t.d(r,{frontMatter:()=>o,toc:()=>l,default:()=>h,metadata:()=>n,assets:()=>c,contentTitle:()=>a});var n=JSON.parse('{"id":"paseto/paseto","title":"Paseto","description":"Release","source":"@site/docs/contrib/paseto/README.md","sourceDirName":"paseto","slug":"/paseto/","permalink":"/contrib/next/paseto/","draft":false,"unlisted":false,"editUrl":"https://github.com/gofiber/contrib/edit/main/paseto/README.md","tags":[],"version":"current","lastUpdatedAt":1762030608000,"frontMatter":{"id":"paseto"},"sidebar":"left_sidebar","previous":{"title":"Example","permalink":"/contrib/next/otel/example/"},"next":{"title":"Sentry","permalink":"/contrib/next/sentry/"}}'),i=t(74848),s=t(84429);let o={id:"paseto"},a="Paseto",c={},l=[{value:"Go version support",id:"go-version-support",level:2},{value:"Install",id:"install",level:2},{value:"Signature",id:"signature",level:2},{value:"Config",id:"config",level:2},{value:"Available Extractors",id:"available-extractors",level:2},{value:"Security Considerations",id:"security-considerations",level:3},{value:"Migration from TokenPrefix",id:"migration-from-tokenprefix",level:2},{value:"Examples",id:"examples",level:2},{value:"SymmetricKey",id:"symmetrickey",level:3},{value:"Test it",id:"test-it",level:4},{value:"SymmetricKey + Custom Validator callback",id:"symmetrickey--custom-validator-callback",level:3},{value:"Cookie Extractor Example",id:"cookie-extractor-example",level:3},{value:"Query Extractor Example",id:"query-extractor-example",level:3},{value:"PublicPrivate Key",id:"publicprivate-key",level:3},{value:"Get the payload from the context",id:"get-the-payload-from-the-context",level:4},{value:"Test it",id:"test-it-1",level:4}];function d(e){let r={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"paseto",children:"Paseto"})}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.img,{src:"https://img.shields.io/github/v/tag/gofiber/contrib?filter=paseto*",alt:"Release"}),"\n",(0,i.jsx)(r.a,{href:"https://gofiber.io/discord",children:(0,i.jsx)(r.img,{src:"https://img.shields.io/discord/704680098577514527?style=flat&label=%F0%9F%92%AC%20discord&color=00ACD7",alt:"Discord"})}),"\n",(0,i.jsx)(r.img,{src:"https://github.com/gofiber/contrib/workflows/Test%20paseto/badge.svg",alt:"Test"})]}),"\n",(0,i.jsx)(r.p,{children:"PASETO returns a Web Token (PASETO) auth middleware."}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"For valid token, it sets the payload data in Ctx.Locals and calls next handler."}),"\n",(0,i.jsx)(r.li,{children:'For invalid token, it returns "401 - Unauthorized" error.'}),"\n",(0,i.jsx)(r.li,{children:'For missing token, it returns "400 - BadRequest" error.'}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Compatible with Fiber v3."})}),"\n",(0,i.jsx)(r.h2,{id:"go-version-support",children:"Go version support"}),"\n",(0,i.jsxs)(r.p,{children:["We only support the latest two versions of Go. Visit ",(0,i.jsx)(r.a,{href:"https://go.dev/doc/devel/release",children:"https://go.dev/doc/devel/release"})," for more information."]}),"\n",(0,i.jsx)(r.h2,{id:"install",children:"Install"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:"go get -u github.com/gofiber/fiber/v3\ngo get -u github.com/gofiber/contrib/v3/paseto\ngo get -u github.com/o1egl/paseto\n"})}),"\n",(0,i.jsx)(r.h2,{id:"signature",children:"Signature"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-go",children:"pasetoware.New(config ...pasetoware.Config) func(fiber.Ctx) error\npasetoware.FromContext(c fiber.Ctx) interface{}\n"})}),"\n",(0,i.jsx)(r.h2,{id:"config",children:"Config"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{style:{textAlign:"left"},children:"Property"}),(0,i.jsx)(r.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(r.th,{style:{textAlign:"left"},children:"Description"}),(0,i.jsx)(r.th,{style:{textAlign:"left"},children:"Default"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{style:{textAlign:"left"},children:"Next"}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"func(fiber.Ctx) bool"})}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:"Defines a function to skip this middleware when it returns true."}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"nil"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{style:{textAlign:"left"},children:"SuccessHandler"}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"func(fiber.Ctx) error"})}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:"SuccessHandler defines a function which is executed for a valid token."}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"c.Next()"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{style:{textAlign:"left"},children:"ErrorHandler"}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"func(fiber.Ctx, error) error"})}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:"ErrorHandler defines a function which is executed for an invalid token."}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"401 Invalid or expired PASETO"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{style:{textAlign:"left"},children:"Validate"}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"PayloadValidator"})}),(0,i.jsxs)(r.td,{style:{textAlign:"left"},children:["Defines a function to validate if payload is valid. Optional. In case payload used is created using ",(0,i.jsx)(r.code,{children:"CreateToken"})," function. If token is created using another function, this function must be provided."]}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"nil"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{style:{textAlign:"left"},children:"SymmetricKey"}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"[]byte"})}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:"Secret key to encrypt token. If present the middleware will generate local tokens."}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"nil"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{style:{textAlign:"left"},children:"PrivateKey"}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"ed25519.PrivateKey"})}),(0,i.jsxs)(r.td,{style:{textAlign:"left"},children:["Secret key to sign the tokens. If present (along with its ",(0,i.jsx)(r.code,{children:"PublicKey"}),") the middleware will generate public tokens."]}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"nil"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{style:{textAlign:"left"},children:"PublicKey"}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"crypto.PublicKey"})}),(0,i.jsxs)(r.td,{style:{textAlign:"left"},children:["Public key to verify the tokens. If present (along with ",(0,i.jsx)(r.code,{children:"PrivateKey"}),") the middleware will generate public tokens."]}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"nil"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{style:{textAlign:"left"},children:"Extractor"}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:"Extractor"})}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:"Extractor defines a function to extract the token from the request."}),(0,i.jsx)(r.td,{style:{textAlign:"left"},children:(0,i.jsx)(r.code,{children:'FromAuthHeader("Bearer")'})})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"available-extractors",children:"Available Extractors"}),"\n",(0,i.jsx)(r.p,{children:"PASETO middleware uses the shared Fiber extractors (github.com/gofiber/fiber/v3/extractors) and provides several helpers for different token sources:"}),"\n",(0,i.jsx)(r.p,{children:"Import them like this:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-go",children:'import "github.com/gofiber/fiber/v3/extractors"\n'})}),"\n",(0,i.jsx)(r.p,{children:"For an overview and additional examples, see the Fiber Extractors guide:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.a,{href:"https://docs.gofiber.io/guide/extractors",children:"https://docs.gofiber.io/guide/extractors"})}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"extractors.FromAuthHeader(prefix string)"}),' - Extracts token from the Authorization header using the given scheme prefix (e.g., "Bearer"). ',(0,i.jsx)(r.strong,{children:"This is the recommended and most secure method."})]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"extractors.FromHeader(header string)"})," - Extracts token from the specified HTTP header"]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"extractors.FromQuery(param string)"})," - Extracts token from URL query parameters"]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"extractors.FromParam(param string)"})," - Extracts token from URL path parameters"]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"extractors.FromCookie(key string)"})," - Extracts token from cookies"]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"extractors.FromForm(param string)"})," - Extracts token from form data"]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"extractors.Chain(extrs ...extractors.Extractor)"})," - Tries multiple extractors in order until one succeeds"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,i.jsxs)(r.p,{children:["\u26A0\uFE0F ",(0,i.jsx)(r.strong,{children:"Security Warning"}),": When choosing an extractor, consider the security implications:"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"URL-based extractors"})," (",(0,i.jsx)(r.code,{children:"FromQuery"}),", ",(0,i.jsx)(r.code,{children:"FromParam"}),"): Tokens can leak through server logs, browser referrer headers, proxy logs, and browser history. Use only for development or when security is not a primary concern."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Form-based extractors"})," (",(0,i.jsx)(r.code,{children:"FromForm"}),"): Similar risks to URL extractors, especially if forms are submitted via GET requests."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Header-based extractors"})," (",(0,i.jsx)(r.code,{children:"FromAuthHeader"}),", ",(0,i.jsx)(r.code,{children:"FromHeader"}),"): Most secure as headers are not typically logged or exposed in referrers."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Cookie-based extractors"})," (",(0,i.jsx)(r.code,{children:"FromCookie"}),"): Secure for web applications but requires proper cookie security settings (HttpOnly, Secure, SameSite)."]}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Recommendation"}),": Use ",(0,i.jsx)(r.code,{children:'FromAuthHeader("Bearer")'})," (the default) for production applications unless you have specific requirements that necessitate alternative extractors."]}),"\n",(0,i.jsx)(r.h2,{id:"migration-from-tokenprefix",children:"Migration from TokenPrefix"}),"\n",(0,i.jsxs)(r.p,{children:["If you were previously using ",(0,i.jsx)(r.code,{children:"TokenPrefix"}),", you can now use ",(0,i.jsx)(r.code,{children:"extractors.FromAuthHeader"})," with the prefix:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-go",children:'// Old way\npasetoware.New(pasetoware.Config{\n    SymmetricKey: []byte("secret"),\n    TokenPrefix:  "Bearer",\n})\n\n// New way\npasetoware.New(pasetoware.Config{\n    SymmetricKey: []byte("secret"),\n    Extractor:    extractors.FromAuthHeader("Bearer"),\n})\n'})}),"\n",(0,i.jsx)(r.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(r.p,{children:"Below have a list of some examples that can help you start to use this middleware. In case of any additional example\nthat doesn't show here, please take a look at the test file."}),"\n",(0,i.jsx)(r.h3,{id:"symmetrickey",children:"SymmetricKey"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-go",children:'package main\n\nimport (\n    "time"\n\n    "github.com/gofiber/fiber/v3"\n    "github.com/gofiber/fiber/v3/extractors"\n\n    pasetoware "github.com/gofiber/contrib/v3/paseto"\n)\n\nconst secretSymmetricKey = "symmetric-secret-key (size = 32)"\n\nfunc main() {\n\n    app := fiber.New()\n\n    // Login route\n    app.Post("/login", login)\n\n    // Unauthenticated route\n    app.Get("/", accessible)\n\n    // Paseto Middleware with local (encrypted) token\n    apiGroup := app.Group("api", pasetoware.New(pasetoware.Config{\n        SymmetricKey: []byte(secretSymmetricKey),\n        Extractor:    extractors.FromAuthHeader("Bearer"),\n    }))\n\n    // Restricted Routes\n    apiGroup.Get("/restricted", restricted)\n\n    err := app.Listen(":8088")\n    if err != nil {\n        return\n    }\n}\n\nfunc login(c fiber.Ctx) error {\n    user := c.FormValue("user")\n    pass := c.FormValue("pass")\n\n    // Throws Unauthorized error\n    if user != "john" || pass != "doe" {\n        return c.SendStatus(fiber.StatusUnauthorized)\n    }\n\n    // Create token and encrypt it\n    encryptedToken, err := pasetoware.CreateToken([]byte(secretSymmetricKey), user, 12*time.Hour, pasetoware.PurposeLocal)\n    if err != nil {\n        return c.SendStatus(fiber.StatusInternalServerError)\n    }\n\n    return c.JSON(fiber.Map{"token": encryptedToken})\n}\n\nfunc accessible(c fiber.Ctx) error {\n    return c.SendString("Accessible")\n}\n\nfunc restricted(c fiber.Ctx) error {\n    payload := pasetoware.FromContext(c).(string)\n    return c.SendString("Welcome " + payload)\n}\n\n'})}),"\n",(0,i.jsx)(r.h4,{id:"test-it",children:"Test it"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.em,{children:"Login using username and password to retrieve a token."})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:'curl --data "user=john&pass=doe" http://localhost:8088/login\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.em,{children:"Response"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-json",children:'{\n  "token": "<local-token>"\n}\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.em,{children:"Request a restricted resource using the token in Authorization request header."})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:'curl localhost:8088/api/restricted -H "Authorization: Bearer <local-token>"\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.em,{children:"Response"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"Welcome john\n"})}),"\n",(0,i.jsx)(r.h3,{id:"symmetrickey--custom-validator-callback",children:"SymmetricKey + Custom Validator callback"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-go",children:'package main\n\nimport (\n    "encoding/json"\n    "time"\n\n    "github.com/gofiber/fiber/v3"\n    "github.com/gofiber/fiber/v3/extractors"\n    "github.com/o1egl/paseto"\n\n    pasetoware "github.com/gofiber/contrib/v3/paseto"\n)\n\nconst secretSymmetricKey = "symmetric-secret-key (size = 32)"\n\ntype customPayloadStruct struct {\n    Name      string    `json:"name"`\n    ExpiresAt time.Time `json:"expiresAt"`\n}\n\nfunc main() {\n\n    app := fiber.New()\n\n    // Login route\n    app.Post("/login", login)\n\n    // Unauthenticated route\n    app.Get("/", accessible)\n\n    // Paseto Middleware with local (encrypted) token\n    apiGroup := app.Group("api", pasetoware.New(pasetoware.Config{\n        SymmetricKey: []byte(secretSymmetricKey),\n        Extractor:    extractors.FromAuthHeader("Bearer"),\n        Validate: func(decrypted []byte) (any, error) {\n            var payload customPayloadStruct\n            err := json.Unmarshal(decrypted, &payload)\n            return payload, err\n        },\n    }))\n\n    // Restricted Routes\n    apiGroup.Get("/restricted", restricted)\n\n    err := app.Listen(":8088")\n    if err != nil {\n        return\n    }\n}\n\nfunc login(c fiber.Ctx) error {\n    user := c.FormValue("user")\n    pass := c.FormValue("pass")\n\n    // Throws Unauthorized error\n    if user != "john" || pass != "doe" {\n        return c.SendStatus(fiber.StatusUnauthorized)\n    }\n\n    // Create the payload\n    payload := customPayloadStruct{\n        Name:      "John Doe",\n        ExpiresAt: time.Now().Add(12 * time.Hour),\n    }\n\n    // Create token and encrypt it\n    encryptedToken, err := paseto.NewV2().Encrypt([]byte(secretSymmetricKey), payload, nil)\n    if err != nil {\n        return c.SendStatus(fiber.StatusInternalServerError)\n    }\n\n    return c.JSON(fiber.Map{"token": encryptedToken})\n}\n\nfunc accessible(c fiber.Ctx) error {\n    return c.SendString("Accessible")\n}\n\nfunc restricted(c fiber.Ctx) error {\n    payload := pasetoware.FromContext(c).(customPayloadStruct)\n    return c.SendString("Welcome " + payload.Name)\n}\n\n'})}),"\n",(0,i.jsx)(r.h3,{id:"cookie-extractor-example",children:"Cookie Extractor Example"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-go",children:'package main\n\nimport (\n    "github.com/gofiber/fiber/v3"\n    "github.com/gofiber/fiber/v3/extractors"\n\n    pasetoware "github.com/gofiber/contrib/v3/paseto"\n)\n\nconst secretSymmetricKey = "symmetric-secret-key (size = 32)"\n\nfunc main() {\n    app := fiber.New()\n\n    // Paseto Middleware with cookie extractor\n    app.Use(pasetoware.New(pasetoware.Config{\n        SymmetricKey: []byte(secretSymmetricKey),\n        Extractor:    extractors.FromCookie("token"),\n    }))\n\n    app.Get("/protected", func(c fiber.Ctx) error {\n        return c.SendString("Protected route")\n    })\n\n    app.Listen(":8080")\n}\n'})}),"\n",(0,i.jsx)(r.h3,{id:"query-extractor-example",children:"Query Extractor Example"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-go",children:'package main\n\nimport (\n    "github.com/gofiber/fiber/v3"\n    "github.com/gofiber/fiber/v3/extractors"\n\n    pasetoware "github.com/gofiber/contrib/v3/paseto"\n)\n\nconst secretSymmetricKey = "symmetric-secret-key (size = 32)"\n\nfunc main() {\n    app := fiber.New()\n\n    // Paseto Middleware with query extractor\n    app.Use(pasetoware.New(pasetoware.Config{\n        SymmetricKey: []byte(secretSymmetricKey),\n        Extractor:    extractors.FromQuery("token"),\n    }))\n\n    app.Get("/protected", func(c fiber.Ctx) error {\n        return c.SendString("Protected route")\n    })\n\n    app.Listen(":8080")\n}\n'})}),"\n",(0,i.jsx)(r.h3,{id:"publicprivate-key",children:"PublicPrivate Key"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-go",children:'package main\n\nimport (\n    "crypto/ed25519"\n    "encoding/hex"\n    "time"\n\n    "github.com/gofiber/fiber/v3"\n    "github.com/gofiber/fiber/v3/extractors"\n\n    pasetoware "github.com/gofiber/contrib/v3/paseto"\n)\n\nconst privateKeySeed = "e9c67fe2433aa4110caf029eba70df2c822cad226b6300ead3dcae443ac3810f"\n\nvar seed, _ = hex.DecodeString(privateKeySeed)\nvar privateKey = ed25519.NewKeyFromSeed(seed)\n\ntype customPayloadStruct struct {\n    Name      string    `json:"name"`\n    ExpiresAt time.Time `json:"expiresAt"`\n}\n\nfunc main() {\n\n    app := fiber.New()\n\n    // Login route\n    app.Post("/login", login)\n\n    // Unauthenticated route\n    app.Get("/", accessible)\n\n    // Paseto Middleware with public (signed) token\n    apiGroup := app.Group("api", pasetoware.New(pasetoware.Config{\n        Extractor:  extractors.FromAuthHeader("Bearer"),\n        PrivateKey: privateKey,\n        PublicKey:  privateKey.Public(),\n    }))\n\n    // Restricted Routes\n    apiGroup.Get("/restricted", restricted)\n\n    err := app.Listen(":8088")\n    if err != nil {\n        return\n    }\n}\n\nfunc login(c fiber.Ctx) error {\n    user := c.FormValue("user")\n    pass := c.FormValue("pass")\n\n    // Throws Unauthorized error\n    if user != "john" || pass != "doe" {\n        return c.SendStatus(fiber.StatusUnauthorized)\n    }\n\n    // Create token and sign it\n    signedToken, err := pasetoware.CreateToken(privateKey, user, 12*time.Hour, pasetoware.PurposePublic)\n    if err != nil {\n        return c.SendStatus(fiber.StatusInternalServerError)\n    }\n\n    return c.JSON(fiber.Map{"token": signedToken})\n}\n\nfunc accessible(c fiber.Ctx) error {\n    return c.SendString("Accessible")\n}\n\nfunc restricted(c fiber.Ctx) error {\n    payload := pasetoware.FromContext(c).(string)\n    return c.SendString("Welcome " + payload)\n}\n\n'})}),"\n",(0,i.jsx)(r.h4,{id:"get-the-payload-from-the-context",children:"Get the payload from the context"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-go",children:"payloadFromCtx := pasetoware.FromContext(c)  \nif payloadFromCtx == nil {  \n    // Handle case where token is not in context, e.g. by returning an error  \n    return  \n}  \npayload := payloadFromCtx.(string)  \n"})}),"\n",(0,i.jsx)(r.h4,{id:"test-it-1",children:"Test it"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.em,{children:"Login using username and password to retrieve a token."})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:'curl --data "user=john&pass=doe" http://localhost:8088/login\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.em,{children:"Response"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-json",children:'{\n  "token": "<public-token>"\n}\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.em,{children:"Request a restricted resource using the token in Authorization request header."})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:'curl localhost:8088/api/restricted -H "Authorization: Bearer <public-token>"\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.em,{children:"Response"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-text",children:"Welcome John Doe\n"})})]})}function h(e={}){let{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},84429:function(e,r,t){t.d(r,{R:()=>o,x:()=>a});var n=t(96540);let i={},s=n.createContext(i);function o(e){let r=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(s.Provider,{value:r},e.children)}}}]);