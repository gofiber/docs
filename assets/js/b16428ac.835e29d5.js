"use strict";(self.webpackChunkfiber_docs=self.webpackChunkfiber_docs||[]).push([["22381"],{1690:function(e,t,n){n.r(t),n.d(t,{frontMatter:()=>s,toc:()=>o,default:()=>x,metadata:()=>i,assets:()=>c,contentTitle:()=>d});var i=JSON.parse('{"id":"newrelic/newrelic","title":"New Relic","description":"Release","source":"@site/docs/contrib/newrelic/README.md","sourceDirName":"newrelic","slug":"/newrelic/","permalink":"/contrib/next/newrelic/","draft":false,"unlisted":false,"editUrl":"https://github.com/gofiber/contrib/edit/main/v3/newrelic/README.md","tags":[],"version":"current","lastUpdatedAt":1771794478000,"frontMatter":{"id":"newrelic"},"sidebar":"left_sidebar","previous":{"title":"Monitor","permalink":"/contrib/next/monitor/"},"next":{"title":"OPA","permalink":"/contrib/next/opa/"}}'),l=n(74848),r=n(84429);let s={id:"newrelic"},d="New Relic",c={},o=[{value:"Go version support",id:"go-version-support",level:2},{value:"Install",id:"install",level:2},{value:"Signature",id:"signature",level:2},{value:"Config",id:"config",level:2},{value:"Usage",id:"usage",level:2},{value:"Usage with existing New Relic application",id:"usage-with-existing-new-relic-application",level:2}];function a(e){let t={a:"a",code:"code",del:"del",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.header,{children:(0,l.jsx)(t.h1,{id:"new-relic",children:"New Relic"})}),"\n",(0,l.jsxs)(t.p,{children:[(0,l.jsx)(t.img,{src:"https://img.shields.io/github/v/tag/gofiber/contrib?filter=*newrelic*",alt:"Release"}),"\n",(0,l.jsx)(t.a,{href:"https://gofiber.io/discord",children:(0,l.jsx)(t.img,{src:"https://img.shields.io/discord/704680098577514527?style=flat&label=%F0%9F%92%AC%20discord&color=00ACD7",alt:"Discord"})}),"\n",(0,l.jsx)(t.img,{src:"https://github.com/gofiber/contrib/workflows/Test%20newrelic/badge.svg",alt:"Test"})]}),"\n",(0,l.jsxs)(t.p,{children:[(0,l.jsx)(t.a,{href:"https://github.com/newrelic/go-agent",children:"New Relic"})," support for Fiber."]}),"\n",(0,l.jsxs)(t.p,{children:["Incoming request headers are forwarded to New Relic transactions by default. This enables distributed tracing header processing, but can also forward sensitive headers. Use ",(0,l.jsx)(t.code,{children:"RequestHeaderFilter"})," to allowlist or redact headers as needed."]}),"\n",(0,l.jsx)(t.p,{children:(0,l.jsx)(t.strong,{children:"Compatible with Fiber v3."})}),"\n",(0,l.jsx)(t.h2,{id:"go-version-support",children:"Go version support"}),"\n",(0,l.jsxs)(t.p,{children:["We only support the latest two versions of Go. Visit ",(0,l.jsx)(t.a,{href:"https://go.dev/doc/devel/release",children:"https://go.dev/doc/devel/release"})," for more information."]}),"\n",(0,l.jsx)(t.h2,{id:"install",children:"Install"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-sh",children:"go get -u github.com/gofiber/fiber/v3\ngo get -u github.com/gofiber/contrib/v3/newrelic\n"})}),"\n",(0,l.jsx)(t.h2,{id:"signature",children:"Signature"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-go",children:"newrelic.New(config newrelic.Config) fiber.Handler\n"})}),"\n",(0,l.jsx)(t.h2,{id:"config",children:"Config"}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Property"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Description"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Default"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"License"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"string"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Required - New Relic License Key"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:'""'})})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"AppName"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"string"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"New Relic Application Name"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"fiber-api"})})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Enabled"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"bool"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Enable/Disable New Relic"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"false"})})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.del,{children:"TransportType"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.del,{children:(0,l.jsx)(t.code,{children:"string"})})}),(0,l.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,l.jsx)(t.del,{children:"Can be HTTP or HTTPS"})," (Deprecated)"]}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.del,{children:(0,l.jsx)(t.code,{children:'"HTTP"'})})})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Application"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"Application"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Existing New Relic App"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"nil"})})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"ErrorStatusCodeHandler"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"func(c fiber.Ctx, err error) int"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"If you want to change newrelic status code, you can use it."}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"DefaultErrorStatusCodeHandler"})})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Next"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"func(c fiber.Ctx) bool"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Next defines a function to skip this middleware when returned true."}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"nil"})})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"RequestHeaderFilter"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"func(key, value string) bool"})}),(0,l.jsxs)(t.td,{style:{textAlign:"left"},children:["Return ",(0,l.jsx)(t.code,{children:"true"})," to forward a request header to New Relic, ",(0,l.jsx)(t.code,{children:"false"})," to skip it."]}),(0,l.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,l.jsx)(t.code,{children:"nil"})," (forward all headers)"]})]})]})]}),"\n",(0,l.jsx)(t.h2,{id:"usage",children:"Usage"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-go",children:'package main\n\nimport (\n    "github.com/gofiber/fiber/v3"\n    middleware "github.com/gofiber/contrib/v3/newrelic"\n)\n\nfunc main() {\n    app := fiber.New()\n\n    app.Get("/", func(ctx fiber.Ctx) error {\n        return ctx.SendStatus(200)\n    })\n\n    cfg := middleware.Config{\n        License:       "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",\n        AppName:       "MyCustomApi",\n        Enabled:       true,\n    }\n\n    app.Use(middleware.New(cfg))\n\n    app.Listen(":8080")\n}\n'})}),"\n",(0,l.jsx)(t.h2,{id:"usage-with-existing-new-relic-application",children:"Usage with existing New Relic application"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-go",children:'package main\n\nimport (\n    "github.com/gofiber/fiber/v3"\n    middleware "github.com/gofiber/contrib/v3/newrelic"\n    nr "github.com/newrelic/go-agent/v3/newrelic"\n)\n\nfunc main() {\n    nrApp, err := nr.NewApplication(\n        nr.ConfigAppName("MyCustomApi"),\n        nr.ConfigLicense("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"),\n        nr.ConfigEnabled(true),\n    )\n\n    app := fiber.New()\n\n    app.Get("/", func(ctx fiber.Ctx) error {\n        return ctx.SendStatus(200)\n    })\n    \n    app.Get("/foo", func(ctx fiber.Ctx) error {\n        txn := middleware.FromContext(ctx)\n        segment := txn.StartSegment("foo segment")\n        defer segment.End()\n        \n        // do foo \n\n        return nil\n    })\n\n    cfg := middleware.Config{\n        Application:       nrApp,\n    }\n\n    app.Use(middleware.New(cfg))\n\n    app.Listen(":8080")\n}\n'})})]})}function x(e={}){let{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,l.jsx)(t,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},84429:function(e,t,n){n.d(t,{R:()=>s,x:()=>d});var i=n(96540);let l={},r=i.createContext(l);function s(e){let t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);