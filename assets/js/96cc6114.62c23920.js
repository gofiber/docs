"use strict";(self.webpackChunkfiber_docs=self.webpackChunkfiber_docs||[]).push([["26417"],{85890:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>l,toc:()=>a,default:()=>h,metadata:()=>r,assets:()=>c,contentTitle:()=>o});var r=JSON.parse('{"id":"jwt/jwt","title":"JWT","description":"Release","source":"@site/docs/contrib/jwt/README.md","sourceDirName":"jwt","slug":"/jwt/","permalink":"/contrib/next/jwt/","draft":false,"unlisted":false,"editUrl":"https://github.com/gofiber/contrib/edit/main/v3/jwt/README.md","tags":[],"version":"current","lastUpdatedAt":1771794478000,"frontMatter":{"id":"jwt"},"sidebar":"left_sidebar","previous":{"title":"I18n","permalink":"/contrib/next/i18n/"},"next":{"title":"LoadShed","permalink":"/contrib/next/loadshed/"}}'),i=t(74848),s=t(84429);let l={id:"jwt"},o="JWT",c={},a=[{value:"Go version support",id:"go-version-support",level:2},{value:"Install",id:"install",level:2},{value:"Signature",id:"signature",level:2},{value:"Config",id:"config",level:2},{value:"Available Extractors",id:"available-extractors",level:2},{value:"Security Considerations",id:"security-considerations",level:3},{value:"HS256 Example",id:"hs256-example",level:2},{value:"Cookie Extractor Example",id:"cookie-extractor-example",level:2},{value:"HS256 Test",id:"hs256-test",level:2},{value:"RS256 Example",id:"rs256-example",level:2},{value:"RS256 Test",id:"rs256-test",level:2},{value:"JWK Set Test",id:"jwk-set-test",level:2},{value:"Custom KeyFunc example",id:"custom-keyfunc-example",level:2}];function d(e){let n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"jwt",children:"JWT"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.img,{src:"https://img.shields.io/github/v/tag/gofiber/contrib?filter=*jwt*",alt:"Release"}),"\n",(0,i.jsx)(n.a,{href:"https://gofiber.io/discord",children:(0,i.jsx)(n.img,{src:"https://img.shields.io/discord/704680098577514527?style=flat&label=%F0%9F%92%AC%20discord&color=00ACD7",alt:"Discord"})}),"\n",(0,i.jsx)(n.img,{src:"https://github.com/gofiber/contrib/workflows/Test%20jwt/badge.svg",alt:"Test"})]}),"\n",(0,i.jsx)(n.p,{children:'JWT returns a JSON Web Token (JWT) auth middleware.\nFor valid token, it sets the token in Ctx.Locals and calls next handler.\nFor invalid token, it returns "401 - Unauthorized" error.\nFor missing token, it returns "400 - Bad Request" error.'}),"\n",(0,i.jsxs)(n.p,{children:["Special thanks and credits to ",(0,i.jsx)(n.a,{href:"https://echo.labstack.com/middleware/jwt",children:"Echo"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Compatible with Fiber v3."})}),"\n",(0,i.jsx)(n.h2,{id:"go-version-support",children:"Go version support"}),"\n",(0,i.jsxs)(n.p,{children:["We only support the latest two versions of Go. Visit ",(0,i.jsx)(n.a,{href:"https://go.dev/doc/devel/release",children:"https://go.dev/doc/devel/release"})," for more information."]}),"\n",(0,i.jsx)(n.h2,{id:"install",children:"Install"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"go get -u github.com/gofiber/fiber/v3\ngo get -u github.com/gofiber/contrib/v3/jwt\ngo get -u github.com/golang-jwt/jwt/v5\n"})}),"\n",(0,i.jsx)(n.h2,{id:"signature",children:"Signature"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"jwtware.New(config ...jwtware.Config) func(fiber.Ctx) error\njwtware.FromContext(c fiber.Ctx) *jwt.Token\n"})}),"\n",(0,i.jsx)(n.h2,{id:"config",children:"Config"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Property"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Description"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Default"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Next"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"func(fiber.Ctx) bool"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Defines a function to skip this middleware when it returns true"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"nil"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"SuccessHandler"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"func(fiber.Ctx) error"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Executed when a token is valid."}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"c.Next()"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"ErrorHandler"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"func(fiber.Ctx, error) error"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"ErrorHandler defines a function which is executed for an invalid token."}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"401 Invalid or expired JWT"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"SigningKey"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"SigningKey"})}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Signing key used to validate the token. Used as a fallback if ",(0,i.jsx)(n.code,{children:"SigningKeys"})," is empty."]}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"nil"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"SigningKeys"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"map[string]SigningKey"})}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Map of signing keys used to validate tokens via the ",(0,i.jsx)(n.code,{children:"kid"})," header."]}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"nil"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Claims"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"jwt.Claims"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Claims are extendable claims data defining token content."}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"jwt.MapClaims{}"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Extractor"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"Extractor"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Function used to extract the token from the request."}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:'FromAuthHeader("Bearer")'})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TokenProcessorFunc"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"func(token string) (string, error)"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"TokenProcessorFunc processes the token extracted using the Extractor."}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"nil"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"KeyFunc"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"jwt.Keyfunc"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"User-defined function that supplies the public key for token validation."}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,i.jsx)(n.code,{children:"nil"})," (uses internal default)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"JWKSetURLs"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"[]string"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"List of JSON Web Key (JWK) Set URLs used to obtain signing keys for parsing JWTs."}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"nil"})})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"available-extractors",children:"Available Extractors"}),"\n",(0,i.jsx)(n.p,{children:"JWT middleware uses the shared Fiber extractors (github.com/gofiber/fiber/v3/extractors) and provides several helpers for different token sources. Import them with:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'import "github.com/gofiber/fiber/v3/extractors"\n'})}),"\n",(0,i.jsx)(n.p,{children:"For an overview and additional examples, see the Fiber Extractors guide:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://docs.gofiber.io/guide/extractors",children:"https://docs.gofiber.io/guide/extractors"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"extractors.FromAuthHeader(prefix string)"}),' - Extracts token from the Authorization header using the given scheme prefix (e.g., "Bearer"). ',(0,i.jsx)(n.strong,{children:"This is the recommended and most secure method."})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"extractors.FromHeader(header string)"})," - Extracts token from the specified HTTP header"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"extractors.FromQuery(param string)"})," - Extracts token from URL query parameters"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"extractors.FromParam(param string)"})," - Extracts token from URL path parameters"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"extractors.FromCookie(key string)"})," - Extracts token from cookies"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"extractors.FromForm(param string)"})," - Extracts token from form data"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"extractors.Chain(extrs ...extractors.Extractor)"})," - Tries multiple extractors in order until one succeeds"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,i.jsxs)(n.p,{children:["\u26A0\uFE0F ",(0,i.jsx)(n.strong,{children:"Security Warning"}),": When choosing an extractor, consider the security implications:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"URL-based extractors"})," (",(0,i.jsx)(n.code,{children:"FromQuery"}),", ",(0,i.jsx)(n.code,{children:"FromParam"}),"): Tokens can leak through server logs, browser referrer headers, proxy logs, and browser history. Use only for development or when security is not a primary concern."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Form-based extractors"})," (",(0,i.jsx)(n.code,{children:"FromForm"}),"): Similar risks to URL extractors, especially if forms are submitted via GET requests."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Header-based extractors"})," (",(0,i.jsx)(n.code,{children:"FromAuthHeader"}),", ",(0,i.jsx)(n.code,{children:"FromHeader"}),"): Most secure as headers are not typically logged or exposed in referrers."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cookie-based extractors"})," (",(0,i.jsx)(n.code,{children:"FromCookie"}),"): Secure for web applications but requires proper cookie security settings (HttpOnly, Secure, SameSite)."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Recommendation"}),": Use ",(0,i.jsx)(n.code,{children:'FromAuthHeader("Bearer")'})," (the default) for production applications unless you have specific requirements that necessitate alternative extractors."]}),"\n",(0,i.jsx)(n.h2,{id:"hs256-example",children:"HS256 Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n "time"\n\n "github.com/gofiber/fiber/v3"\n "github.com/gofiber/fiber/v3/extractors"\n\n jwtware "github.com/gofiber/contrib/v3/jwt"\n "github.com/golang-jwt/jwt/v5"\n)\n\nfunc main() {\n app := fiber.New()\n\n // Login route\n app.Post("/login", login)\n\n // Unauthenticated route\n app.Get("/", accessible)\n\n // JWT Middleware\n app.Use(jwtware.New(jwtware.Config{\n  SigningKey: jwtware.SigningKey{Key: []byte("secret")},\n  Extractor:  extractors.FromAuthHeader("Bearer"),\n }))\n\n // Restricted Routes\n app.Get("/restricted", restricted)\n\n app.Listen(":3000")\n}\n\nfunc login(c fiber.Ctx) error {\n user := c.FormValue("user")\n pass := c.FormValue("pass")\n\n // Throws Unauthorized error\n if user != "john" || pass != "doe" {\n  return c.SendStatus(fiber.StatusUnauthorized)\n }\n\n // Create the Claims\n claims := jwt.MapClaims{\n  "name":  "John Doe",\n  "admin": true,\n  "exp":   time.Now().Add(time.Hour * 72).Unix(),\n }\n\n // Create token\n token := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)\n\n // Generate encoded token and send it as response.\n t, err := token.SignedString([]byte("secret"))\n if err != nil {\n  return c.SendStatus(fiber.StatusInternalServerError)\n }\n\n return c.JSON(fiber.Map{"token": t})\n}\n\nfunc accessible(c fiber.Ctx) error {\n return c.SendString("Accessible")\n}\n\nfunc restricted(c fiber.Ctx) error {\n    user := jwtware.FromContext(c)\n    claims := user.Claims.(jwt.MapClaims)\n    name := claims["name"].(string)\n    return c.SendString("Welcome " + name)\n}\n\n'})}),"\n",(0,i.jsx)(n.h2,{id:"cookie-extractor-example",children:"Cookie Extractor Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n "github.com/gofiber/fiber/v3"\n\n jwtware "github.com/gofiber/contrib/v3/jwt"\n)\n\nfunc main() {\n app := fiber.New()\n\n // JWT Middleware with cookie extractor\n app.Use(jwtware.New(jwtware.Config{\n  SigningKey: jwtware.SigningKey{Key: []byte("secret")},\n  Extractor:  extractors.FromCookie("token"),\n }))\n\n app.Get("/protected", func(c fiber.Ctx) error {\n  return c.SendString("Protected route")\n })\n\n app.Listen(":3000")\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"hs256-test",children:"HS256 Test"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Login using username and password to retrieve a token."})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl --data "user=john&pass=doe" http://localhost:3000/login\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Response"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0NjE5NTcxMzZ9.RB3arc4-OyzASAaUhC2W3ReWaXAt_z2Fd3BN4aWTgEY"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Request a restricted resource using the token in Authorization request header."})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl localhost:3000/restricted -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0NjE5NTcxMzZ9.RB3arc4-OyzASAaUhC2W3ReWaXAt_z2Fd3BN4aWTgEY"\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Response"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"Welcome John Doe\n"})}),"\n",(0,i.jsx)(n.h2,{id:"rs256-example",children:"RS256 Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n "crypto/rand"\n "crypto/rsa"\n "log"\n "time"\n\n "github.com/gofiber/fiber/v3"\n\n "github.com/golang-jwt/jwt/v5"\n\n jwtware "github.com/gofiber/contrib/v3/jwt"\n)\n\nvar (\n // Obviously, this is just a test example. Do not do this in production.\n // In production, you would have the private key and public key pair generated\n // in advance. NEVER add a private key to any GitHub repo.\n privateKey *rsa.PrivateKey\n)\n\nfunc main() {\n app := fiber.New()\n\n // Just as a demo, generate a new private/public key pair on each run. See note above.\n rng := rand.Reader\n var err error\n privateKey, err = rsa.GenerateKey(rng, 2048)\n if err != nil {\n  log.Fatalf("rsa.GenerateKey: %v", err)\n }\n\n // Login route\n app.Post("/login", login)\n\n // Unauthenticated route\n app.Get("/", accessible)\n\n // JWT Middleware\n app.Use(jwtware.New(jwtware.Config{\n  SigningKey: jwtware.SigningKey{\n   JWTAlg: jwtware.RS256,\n   Key:    privateKey.Public(),\n  },\n  Extractor: extractors.FromAuthHeader("Bearer"),\n }))\n\n // Restricted Routes\n app.Get("/restricted", restricted)\n\n app.Listen(":3000")\n}\n\nfunc login(c fiber.Ctx) error {\n user := c.FormValue("user")\n pass := c.FormValue("pass")\n\n // Throws Unauthorized error\n if user != "john" || pass != "doe" {\n  return c.SendStatus(fiber.StatusUnauthorized)\n }\n\n // Create the Claims\n claims := jwt.MapClaims{\n  "name":  "John Doe",\n  "admin": true,\n  "exp":   time.Now().Add(time.Hour * 72).Unix(),\n }\n\n // Create token\n token := jwt.NewWithClaims(jwt.SigningMethodRS256, claims)\n\n // Generate encoded token and send it as response.\n t, err := token.SignedString(privateKey)\n if err != nil {\n  log.Printf("token.SignedString: %v", err)\n  return c.SendStatus(fiber.StatusInternalServerError)\n }\n\n return c.JSON(fiber.Map{"token": t})\n}\n\nfunc accessible(c fiber.Ctx) error {\n return c.SendString("Accessible")\n}\n\nfunc restricted(c fiber.Ctx) error {\n    user := jwtware.FromContext(c)\n    claims := user.Claims.(jwt.MapClaims)\n    name := claims["name"].(string)\n    return c.SendString("Welcome " + name)\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"rs256-test",children:"RS256 Test"}),"\n",(0,i.jsx)(n.p,{children:"The RS256 is actually identical to the HS256 test above."}),"\n",(0,i.jsx)(n.h2,{id:"jwk-set-test",children:"JWK Set Test"}),"\n",(0,i.jsxs)(n.p,{children:["The tests are identical to basic ",(0,i.jsx)(n.code,{children:"JWT"})," tests above, with exception that ",(0,i.jsx)(n.code,{children:"JWKSetURLs"})," to valid public keys collection in JSON Web Key (JWK) Set format should be supplied. See ",(0,i.jsx)(n.a,{href:"https://www.rfc-editor.org/rfc/rfc7517",children:"RFC 7517"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"custom-keyfunc-example",children:"Custom KeyFunc example"}),"\n",(0,i.jsx)(n.p,{children:"KeyFunc defines a user-defined function that supplies the public key for a token validation.\nThe function shall take care of verifying the signing algorithm and selecting the proper key.\nA user-defined KeyFunc can be useful if tokens are issued by an external party."}),"\n",(0,i.jsx)(n.p,{children:"When a user-defined KeyFunc is provided, SigningKey, SigningKeys, and SigningMethod are ignored.\nThis is one of the three options to provide a token validation key.\nThe order of precedence is a user-defined KeyFunc, SigningKeys and SigningKey.\nRequired if neither SigningKeys nor SigningKey is provided.\nDefault to an internal implementation verifying the signing algorithm and selecting the proper key."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n "fmt"\n  "github.com/gofiber/fiber/v3"\n\n  jwtware "github.com/gofiber/contrib/v3/jwt"\n  "github.com/golang-jwt/jwt/v5"\n)\n\nfunc main() {\n app := fiber.New()\n\n app.Use(jwtware.New(jwtware.Config{\n  KeyFunc:   customKeyFunc(),\n  Extractor: extractors.FromAuthHeader("Bearer"),\n }))\n\n app.Get("/ok", func(c fiber.Ctx) error {\n  return c.SendString("OK")\n })\n}\n\nfunc customKeyFunc() jwt.Keyfunc {\n return func(t *jwt.Token) (interface{}, error) {\n  // Always check the signing method\n  if t.Method.Alg() != jwtware.HS256 {\n   return nil, fmt.Errorf("Unexpected jwt signing method=%v", t.Header["alg"])\n  }\n\n  // TODO custom implementation of loading signing key like from a database\n    signingKey := "secret"\n\n  return []byte(signingKey), nil\n }\n}\n'})})]})}function h(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},84429:function(e,n,t){t.d(n,{R:()=>l,x:()=>o});var r=t(96540);let i={},s=r.createContext(i);function l(e){let n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);