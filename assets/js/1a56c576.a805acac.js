"use strict";(self.webpackChunkfiber_docs=self.webpackChunkfiber_docs||[]).push([["57580"],{72447:function(e,r,n){n.r(r),n.d(r,{frontMatter:()=>l,toc:()=>d,default:()=>f,metadata:()=>t,assets:()=>u,contentTitle:()=>c});var t=JSON.parse('{"id":"guide/error-handling","title":"\u{1F41B} Error Handling","description":"Fiber supports centralized error handling by returning an error to the handler which allows you to log errors to external services or send a customized HTTP response to the client.","source":"@site/versioned_docs/version-v2.x/guide/error-handling.md","sourceDirName":"guide","slug":"/guide/error-handling","permalink":"/v2.x/guide/error-handling","draft":false,"unlisted":false,"tags":[],"version":"v2.x","lastUpdatedAt":1771794478000,"sidebarPosition":4,"frontMatter":{"id":"error-handling","title":"\u{1F41B} Error Handling","description":"Fiber supports centralized error handling by returning an error to the handler which allows you to log errors to external services or send a customized HTTP response to the client.","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"\u{1F4DD} Templates","permalink":"/v2.x/guide/templates"},"next":{"title":"\u{1F50E} Validation","permalink":"/v2.x/guide/validation"}}'),a=n(74848),o=n(84429),i=n(84109),s=n(93703);let l={id:"error-handling",title:"\u{1F41B} Error Handling",description:"Fiber supports centralized error handling by returning an error to the handler which allows you to log errors to external services or send a customized HTTP response to the client.",sidebar_position:4},c,u={},d=[{value:"Catching Errors",id:"catching-errors",level:2},{value:"Default Error Handler",id:"default-error-handler",level:2},{value:"Custom Error Handler",id:"custom-error-handler",level:2}];function h(e){let r={a:"a",blockquote:"blockquote",code:"code",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.h2,{id:"catching-errors",children:"Catching Errors"}),"\n",(0,a.jsx)(r.p,{children:"It\u2019s essential to ensure that Fiber catches all errors that occur while running route handlers and middleware. You must return them to the handler function, where Fiber will catch and process them."}),"\n",(0,a.jsx)(i.A,{children:(0,a.jsx)(s.A,{value:"example",label:"Example",children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-go",children:'app.Get("/", func(c *fiber.Ctx) error {\n    // Pass error to Fiber\n    return c.SendFile("file-does-not-exist")\n})\n'})})})}),"\n",(0,a.jsxs)(r.p,{children:["Fiber does not handle ",(0,a.jsx)(r.a,{href:"https://go.dev/blog/defer-panic-and-recover",children:"panics"})," by default. To recover from a panic thrown by any handler in the stack, you need to include the ",(0,a.jsx)(r.code,{children:"Recover"})," middleware below:"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-go",metastring:'title="Example"',children:'package main\n\nimport (\n    "log"\n\n    "github.com/gofiber/fiber/v2"\n    "github.com/gofiber/fiber/v2/middleware/recover"\n)\n\nfunc main() {\n    app := fiber.New()\n\n    app.Use(recover.New())\n\n    app.Get("/", func(c *fiber.Ctx) error {\n        panic("This panic is caught by fiber")\n    })\n\n    log.Fatal(app.Listen(":3000"))\n}\n'})}),"\n",(0,a.jsxs)(r.p,{children:["You could use Fiber's custom error struct to pass an additional ",(0,a.jsx)(r.code,{children:"status code"})," using ",(0,a.jsx)(r.code,{children:"fiber.NewError()"}),". It's optional to pass a message; if this is left empty, it will default to the status code message (",(0,a.jsx)(r.code,{children:"404"})," equals ",(0,a.jsx)(r.code,{children:"Not Found"}),")."]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-go",metastring:'title="Example"',children:'app.Get("/", func(c *fiber.Ctx) error {\n    // 503 Service Unavailable\n    return fiber.ErrServiceUnavailable\n\n    // 503 On vacation!\n    return fiber.NewError(fiber.StatusServiceUnavailable, "On vacation!")\n})\n'})}),"\n",(0,a.jsx)(r.h2,{id:"default-error-handler",children:"Default Error Handler"}),"\n",(0,a.jsxs)(r.p,{children:["Fiber provides an error handler by default. For a standard error, the response is sent as ",(0,a.jsx)(r.strong,{children:"500 Internal Server Error"}),". If the error is of type ",(0,a.jsx)(r.a,{href:"https://godoc.org/github.com/gofiber/fiber#Error",children:"fiber.Error"}),", the response is sent with the provided status code and message."]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-go",metastring:'title="Example"',children:"// Default error handler\nvar DefaultErrorHandler = func(c *fiber.Ctx, err error) error {\n    // Status code defaults to 500\n    code := fiber.StatusInternalServerError\n\n    // Retrieve the custom status code if it's a *fiber.Error\n    var e *fiber.Error\n    if errors.As(err, &e) {\n        code = e.Code\n    }\n\n    // Set Content-Type: text/plain; charset=utf-8\n    c.Set(fiber.HeaderContentType, fiber.MIMETextPlainCharsetUTF8)\n\n    // Return status code with error message\n    return c.Status(code).SendString(err.Error())\n}\n"})}),"\n",(0,a.jsx)(r.h2,{id:"custom-error-handler",children:"Custom Error Handler"}),"\n",(0,a.jsxs)(r.p,{children:["A custom error handler can be set using a ",(0,a.jsx)(r.a,{href:"/v2.x/api/fiber#config",children:"Config "}),"when initializing a ",(0,a.jsx)(r.a,{href:"/v2.x/api/fiber#new",children:"Fiber instance"}),"."]}),"\n",(0,a.jsx)(r.p,{children:"In most cases, the default error handler should be sufficient. However, a custom error handler can come in handy if you want to capture different types of errors and take action accordingly e.g., send a notification email or log an error to the centralized system. You can also send customized responses to the client e.g., error page or just a JSON response."}),"\n",(0,a.jsx)(r.p,{children:"The following example shows how to display error pages for different types of errors."}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-go",metastring:'title="Example"',children:'// Create a new fiber instance with custom config\napp := fiber.New(fiber.Config{\n    // Override default error handler\n    ErrorHandler: func(ctx *fiber.Ctx, err error) error {\n        // Status code defaults to 500\n        code := fiber.StatusInternalServerError\n\n        // Retrieve the custom status code if it\'s a *fiber.Error\n        var e *fiber.Error\n        if errors.As(err, &e) {\n            code = e.Code\n        }\n\n        // Send custom error page\n        err = ctx.Status(code).SendFile(fmt.Sprintf("./%d.html", code))\n        if err != nil {\n            // In case the SendFile fails\n            return ctx.Status(fiber.StatusInternalServerError).SendString("Internal Server Error")\n        }\n\n        // Return from handler\n        return nil\n    },\n})\n\n// ...\n'})}),"\n",(0,a.jsxs)(r.blockquote,{children:["\n",(0,a.jsxs)(r.p,{children:["Special thanks to the ",(0,a.jsx)(r.a,{href:"https://echo.labstack.com/",children:"Echo"})," & ",(0,a.jsx)(r.a,{href:"https://expressjs.com/",children:"Express"})," framework for inspiration regarding error handling."]}),"\n"]})]})}function f(e={}){let{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},93703:function(e,r,n){n.d(r,{A:()=>o});var t=n(74848);n(96540);var a=n(39836);function o({children:e,hidden:r,className:n}){return(0,t.jsx)("div",{role:"tabpanel",className:(0,a.A)("tabItem_Ymn6",n),hidden:r,children:e})}},84109:function(e,r,n){n.d(r,{A:()=>x});var t=n(74848),a=n(96540),o=n(39836),i=n(16364),s=n(68251),l=n(56347),c=n(28004),u=n(25580),d=n(12213),h=n(75734);function f(e){return a.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){let{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p({value:e,tabValues:r}){return r.some(r=>r.value===e)}var m=n(98864);function b({className:e,block:r,selectedValue:n,selectValue:a,tabValues:i}){let l=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),u=e=>{let r=e.currentTarget,t=i[l.indexOf(r)].value;t!==n&&(c(r),a(t))},d=e=>{let r=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{let n=l.indexOf(e.currentTarget)+1;r=l[n]??l[0];break}case"ArrowLeft":{let n=l.indexOf(e.currentTarget)-1;r=l[n]??l[l.length-1]}}r?.focus()};return(0,t.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":r},e),children:i.map(({value:e,label:r,attributes:a})=>(0,t.jsx)("li",{role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,ref:e=>{l.push(e)},onKeyDown:d,onClick:u,...a,className:(0,o.A)("tabs__item","tabItem_LNqP",a?.className,{"tabs__item--active":n===e}),children:r??e},e))})}function g({lazy:e,children:r,selectedValue:n}){let i=(Array.isArray(r)?r:[r]).filter(Boolean);if(e){let e=i.find(e=>e.props.value===n);return e?(0,a.cloneElement)(e,{className:(0,o.A)("margin-top--md",e.props.className)}):null}return(0,t.jsx)("div",{className:"margin-top--md",children:i.map((e,r)=>(0,a.cloneElement)(e,{key:r,hidden:e.props.value!==n}))})}function v(e){let r=function(e){let r,{defaultValue:n,queryString:t=!1,groupId:o}=e,i=function(e){let{values:r,children:n}=e;return(0,a.useMemo)(()=>{let e=r??f(n).map(({props:{value:e,label:r,attributes:n,default:t}})=>({value:e,label:r,attributes:n,default:t})),t=(0,d.XI)(e,(e,r)=>e.value===r.value);if(t.length>0)throw Error(`Docusaurus error: Duplicate values "${t.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`);return e},[r,n])}(e),[s,m]=(0,a.useState)(()=>(function({defaultValue:e,tabValues:r}){if(0===r.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:r}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${r.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}let n=r.find(e=>e.default)??r[0];if(!n)throw Error("Unexpected error: 0 tabValues");return n.value})({defaultValue:n,tabValues:i})),[b,g]=function({queryString:e=!1,groupId:r}){let n=(0,l.W6)(),t=function({queryString:e=!1,groupId:r}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!r)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:e,groupId:r});return[(0,u.aZ)(t),(0,a.useCallback)(e=>{if(!t)return;let r=new URLSearchParams(n.location.search);r.set(t,e),n.replace({...n.location,search:r.toString()})},[t,n])]}({queryString:t,groupId:o}),[v,x]=function({groupId:e}){let r=e?`docusaurus.tab.${e}`:null,[n,t]=(0,h.Dv)(r);return[n,(0,a.useCallback)(e=>{r&&t.set(e)},[r,t])]}({groupId:o}),j=p({value:r=b??v,tabValues:i})?r:null;return(0,c.A)(()=>{j&&m(j)},[j]),{selectedValue:s,selectValue:(0,a.useCallback)(e=>{if(!p({value:e,tabValues:i}))throw Error(`Can't select invalid tab value=${e}`);m(e),g(e),x(e)},[g,x,i]),tabValues:i}}(e);return(0,t.jsxs)("div",{className:(0,o.A)(i.G.tabs.container,"tabs-container","tabList__CuJ"),children:[(0,t.jsx)(b,{...r,...e}),(0,t.jsx)(g,{...r,...e})]})}function x(e){let r=(0,m.A)();return(0,t.jsx)(v,{...e,children:f(e.children)},String(r))}},84429:function(e,r,n){n.d(r,{R:()=>i,x:()=>s});var t=n(96540);let a={},o=t.createContext(a);function i(e){let r=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(o.Provider,{value:r},e.children)}}}]);