"use strict";(self.webpackChunkfiber_docs=self.webpackChunkfiber_docs||[]).push([["37743"],{68577:function(e,n,a){a.r(n),a.d(n,{frontMatter:()=>s,toc:()=>d,default:()=>h,metadata:()=>i,assets:()=>o,contentTitle:()=>c});var i=JSON.parse('{"id":"guide/advance-format","title":"\u{1F41B} Advanced Format","description":"Learn how to use MessagePack (MsgPack) and CBOR for efficient binary serialization in Fiber applications.","source":"@site/versioned_docs/version-v3.x/guide/advance-format.md","sourceDirName":"guide","slug":"/guide/advance-format","permalink":"/guide/advance-format","draft":false,"unlisted":false,"tags":[],"version":"v3.x","lastUpdatedAt":1771794478000,"sidebarPosition":9,"frontMatter":{"id":"advance-format","title":"\u{1F41B} Advanced Format","description":"Learn how to use MessagePack (MsgPack) and CBOR for efficient binary serialization in Fiber applications.","sidebar_position":9},"sidebar":"left_sidebar","previous":{"title":"\u{1F52C} Extractors","permalink":"/guide/extractors"},"next":{"title":"\u{1F9E9} Extra","permalink":"/category/-extra"}}'),r=a(74848),t=a(84429);let s={id:"advance-format",title:"\u{1F41B} Advanced Format",description:"Learn how to use MessagePack (MsgPack) and CBOR for efficient binary serialization in Fiber applications.",sidebar_position:9},c,o={},d=[{value:"MsgPack",id:"msgpack",level:2},{value:"Recommended Libraries",id:"recommended-libraries",level:3},{value:"Installation",id:"installation",level:3},{value:"Example: Using <code>shamaton/msgpack/v3</code>",id:"example-using-shamatonmsgpackv3",level:3},{value:"CBOR",id:"cbor",level:2}];function l(e){let n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"msgpack",children:"MsgPack"}),"\n",(0,r.jsx)(n.p,{children:"Fiber lets you use MessagePack for efficient binary serialization. Use one of the popular Go libraries below to encode and decode data in handlers."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Fiber can bind requests with the ",(0,r.jsx)(n.code,{children:"application/vnd.msgpack"})," content type out of the box. See the ",(0,r.jsx)(n.a,{href:"/api/bind#msgpack",children:"Binding documentation"})," for details."]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"Bind().MsgPack()"})," to bind data to structs, similar to JSON. ",(0,r.jsx)(n.code,{children:"Ctx.AutoFormat()"})," responds with MsgPack when the ",(0,r.jsx)(n.code,{children:"Accept"})," header is ",(0,r.jsx)(n.code,{children:"application/vnd.msgpack"}),". See the ",(0,r.jsx)(n.a,{href:"/api/ctx#autoformat",children:"AutoFormat documentation"})," for more."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"recommended-libraries",children:"Recommended Libraries"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://pkg.go.dev/github.com/vmihailenco/msgpack",children:"github.com/vmihailenco/msgpack"})," \u2014 A widely used, feature-rich MsgPack library."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://pkg.go.dev/github.com/shamaton/msgpack/v3",children:"github.com/shamaton/msgpack/v3"})," \u2014 High-performance MsgPack library."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.p,{children:"Install either library using:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"go get github.com/vmihailenco/msgpack\n# or\ngo get github.com/shamaton/msgpack/v3\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," Fiber doesn't bundle a MsgPack implementation because it's outside the Go standard library. Pick one of the popular libraries in the ecosystem; the two below are widely used and well maintained."]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"example-using-shamatonmsgpackv3",children:["Example: Using ",(0,r.jsx)(n.code,{children:"shamaton/msgpack/v3"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'import (\n    "github.com/gofiber/fiber/v3"\n    "github.com/shamaton/msgpack/v3"\n)\n\ntype User struct {\n    Name string `msgpack:"name"` // tag may vary depending on your MsgPack library\n    Age  int   `msgpack:"age"`\n}\n\nfunc main() {\n    app := fiber.New(fiber.Config{\n        // Optional: Set custom MsgPack encoder/decoder\n        MsgPackEncoder: msgpack.Marshal,\n        MsgPackDecoder: msgpack.Unmarshal,\n    })\n\n    app.Post("/msgpack", func(c fiber.Ctx) error {\n        var user User\n        if err := c.Bind().MsgPack(&user); err != nil {\n            return err\n        }\n        // Content type will be set automatically to application/vnd.msgpack\n        return c.MsgPack(user)\n    })\n\n    app.Listen(":3000")\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"cbor",children:"CBOR"}),"\n",(0,r.jsxs)(n.p,{children:["Fiber doesn't ship with a CBOR implementation. Use a library such as ",(0,r.jsx)(n.a,{href:"https://github.com/fxamacker/cbor",children:"fxamacker/cbor"})," to add encoding and decoding."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"Bind().CBOR()"})," to bind CBOR to structs. ",(0,r.jsx)(n.code,{children:"Ctx.AutoFormat()"})," replies with CBOR when the ",(0,r.jsx)(n.code,{children:"Accept"})," header is ",(0,r.jsx)(n.code,{children:"application/cbor"}),". See the ",(0,r.jsx)(n.a,{href:"/api/ctx#autoformat",children:"AutoFormat documentation"})," for details."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"go get github.com/fxamacker/cbor/v2\n"})}),"\n",(0,r.jsx)(n.p,{children:"Configure Fiber with the chosen library:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'import (\n    "github.com/gofiber/fiber/v3"\n    "github.com/fxamacker/cbor/v2"\n)\n\nfunc main() {\n    app := fiber.New(fiber.Config{\n        CBOREncoder: cbor.Marshal,\n        CBORDecoder: cbor.Unmarshal,\n    })\n\n    type User struct {\n        Name string `cbor:"name"`\n        Age  int    `cbor:"age"`\n    }\n\n    app.Post("/cbor", func(c fiber.Ctx) error {\n        var user User\n        if err := c.Bind().CBOR(&user); err != nil {\n            return err\n        }\n\n        // Content type will be set automatically to application/cbor\n        return c.CBOR(user)\n    })\n\n    app.Listen(":3000")\n}\n'})})]})}function h(e={}){let{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},84429:function(e,n,a){a.d(n,{R:()=>s,x:()=>c});var i=a(96540);let r={},t=i.createContext(r);function s(e){let n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);